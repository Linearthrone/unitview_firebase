(()=>{var e={};e.id=170,e.ids=[170],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3289:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var r=t(687),i=t(3210),n=t(9523),a=t(2158),d=t(9048),o=t(7777),l=t(6660),c=t(140);function u({unitId:e}){let[s,t]=(0,i.useState)(null),[u,m]=(0,i.useState)([]),[x,p]=(0,i.useState)([]),[h,g]=(0,i.useState)([]),[b,f]=(0,i.useState)(null),[v,j]=(0,i.useState)(null),[w,y]=(0,i.useState)(!1),[N,C]=(0,i.useState)(!0),[k,P]=(0,i.useState)(!1),[R,E]=(0,i.useState)({patients:{},nurses:{},pcts:{},staff:{}}),U=(0,i.useMemo)(()=>u.filter(e=>!e.assigned),[u]),_=(0,i.useCallback)(async(e,s)=>{try{let t=x.find(s=>s.id===e),r=u.find(e=>e.id===s);if(!t||!r)return;let i=[...t.assignedRooms];i.includes(r.roomNumber)||(i.push(r.roomNumber),i.sort((e,s)=>parseInt(e)-parseInt(s))),p(x.map(s=>s.id===e?{...s,assignedRooms:i}:s)),m(u.map(e=>e.id===s?{...e,assigned:!0}:e)),E(t=>({...t,nurses:{...t.nurses,[e]:{assignedRooms:i}},patients:{...t.patients,[s]:{assigned:!0}}})),await Promise.all([(0,l.Dr)(e,{assignedRooms:i}),(0,l.Z6)(s,{assigned:!0})]),E(t=>{let{[e]:r,...i}=t.nurses,{[s]:n,...a}=t.patients;return{...t,nurses:i,patients:a}})}catch(e){console.error("Error assigning patient:",e),(0,c.oR)({title:"Error",description:"Failed to assign patient. Changes will be saved when connection is restored.",variant:"destructive"})}},[x,u]),S=(0,i.useCallback)(async(e,s)=>{try{let t=x.find(s=>s.id===e),r=u.find(e=>e.roomNumber===s);if(!t||!r)return;let i=t.assignedRooms.filter(e=>e!==s);p(x.map(s=>s.id===e?{...s,assignedRooms:i}:s)),m(u.map(e=>e.roomNumber===s?{...e,assigned:!1}:e)),E(s=>({...s,nurses:{...s.nurses,[e]:{assignedRooms:i}},patients:{...s.patients,[r.id]:{assigned:!1}}})),await Promise.all([(0,l.Dr)(e,{assignedRooms:i}),(0,l.Z6)(r.id,{assigned:!1})]),E(s=>{let{[e]:t,...i}=s.nurses,{[r.id]:n,...a}=s.patients;return{...s,nurses:i,patients:a}})}catch(e){console.error("Error unassigning patient:",e),(0,c.oR)({title:"Error",description:"Failed to unassign patient. Changes will be saved when connection is restored.",variant:"destructive"})}},[x,u]),A=(0,i.useCallback)(async(e,s)=>{try{p(x.map(t=>t.id===e?{...t,...s}:t)),E(t=>({...t,nurses:{...t.nurses,[e]:{...t.nurses[e],...s}}})),await (0,l.Dr)(e,s),E(s=>{let{[e]:t,...r}=s.nurses;return{...s,nurses:r}}),(0,c.oR)({title:"Nurse Updated",description:"Nurse information has been updated"})}catch(e){console.error("Error updating nurse:",e),(0,c.oR)({title:"Error",description:"Failed to update nurse information. Changes will be saved when connection is restored.",variant:"destructive"})}},[x]),M=(0,i.useCallback)(async(e,s)=>{try{g(h.map(t=>t.id===e?{...t,...s}:t)),E(t=>({...t,pcts:{...t.pcts,[e]:{...t.pcts[e],...s}}})),await (0,l.B5)(e,s),E(s=>{let{[e]:t,...r}=s.pcts;return{...s,pcts:r}}),(0,c.oR)({title:"PCT Updated",description:"PCT information has been updated"})}catch(e){console.error("Error updating PCT:",e),(0,c.oR)({title:"Error",description:"Failed to update PCT information. Changes will be saved when connection is restored.",variant:"destructive"})}},[h]),L=(0,i.useCallback)(async e=>{try{if(!b)return;f({...b,...e}),E(s=>({...s,staff:{...s.staff,[b.id]:{...s.staff[b.id],...e}}})),await (0,l.e4)(b.id,e),E(e=>{let{[b.id]:s,...t}=e.staff;return{...e,staff:t}}),(0,c.oR)({title:"Charge Nurse Updated",description:"Charge nurse information has been updated"})}catch(e){console.error("Error updating charge nurse:",e),(0,c.oR)({title:"Error",description:"Failed to update charge nurse information. Changes will be saved when connection is restored.",variant:"destructive"})}},[b]),q=(0,i.useCallback)(async e=>{try{if(!v)return;j({...v,...e}),E(s=>({...s,staff:{...s.staff,[v.id]:{...s.staff[v.id],...e}}})),await (0,l.e4)(v.id,e),E(e=>{let{[v.id]:s,...t}=e.staff;return{...e,staff:t}}),(0,c.oR)({title:"Unit Clerk Updated",description:"Unit clerk information has been updated"})}catch(e){console.error("Error updating unit clerk:",e),(0,c.oR)({title:"Error",description:"Failed to update unit clerk information. Changes will be saved when connection is restored.",variant:"destructive"})}},[v]),F=(0,i.useCallback)(async()=>{try{let e=Object.entries(R.patients).map(([e,s])=>({id:e,data:s}));e.length>0&&await (0,l.cT)(e),await Promise.all([...Object.entries(R.nurses).map(([e,s])=>(0,l.Dr)(e,s)),...Object.entries(R.pcts).map(([e,s])=>(0,l.B5)(e,s)),...Object.entries(R.staff).map(([e,s])=>(0,l.e4)(e,s))]),E({patients:{},nurses:{},pcts:{},staff:{}}),y(!1),(0,c.oR)({title:"Layout Saved",description:"Unit layout has been saved successfully"})}catch(e){console.error("Error saving layout:",e),(0,c.oR)({title:"Error",description:"Failed to save some changes. Please try again.",variant:"destructive"})}},[R]),O=(0,i.useMemo)(()=>Object.keys(R.patients).length>0||Object.keys(R.nurses).length>0||Object.keys(R.pcts).length>0||Object.keys(R.staff).length>0,[R]);return N||k?(0,r.jsx)("div",{className:"bg-white rounded-lg border p-4 flex items-center justify-center h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-600 border-blue-200 rounded-full animate-spin mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-gray-600",children:k?"Initializing unit data...":"Loading..."})]})}):s?(0,r.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold",children:[s.designation," Patient Grid"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[O&&(0,r.jsxs)("div",{className:"text-amber-600 text-sm flex items-center",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 bg-amber-600 rounded-full mr-1"}),"Unsaved changes"]}),(0,r.jsx)(n.$,{variant:w?"default":"outline",onClick:()=>w?F():y(!0),children:w?"Save Layout":"Edit Layout"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-medium mb-3",children:"Unassigned Patients"}),(0,r.jsxs)("div",{className:"space-y-2",children:[U.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center p-2 border rounded bg-gray-50",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"font-medium",children:["Room ",e.roomNumber]}),e.name&&(0,r.jsx)("span",{className:"ml-2 text-sm",children:e.name})]}),(0,r.jsxs)("span",{className:`px-2 py-1 rounded-full text-xs ${e.acuity>=4?"bg-red-100 text-red-800":e.acuity>=3?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:["Acuity ",e.acuity]})]},e.id)),0===U.length&&(0,r.jsx)("p",{className:"text-sm text-gray-500 italic",children:"All patients assigned"})]})]}),x.map(e=>(0,r.jsx)(a.c,{nurse:e,patients:u,onAssign:s=>_(e.id,s),onUnassign:s=>S(e.id,s),onUpdate:s=>A(e.id,s),editMode:w},e.id)),h.map(e=>(0,r.jsx)(d.I,{pct:e,onUpdate:s=>M(e.id,s),editMode:w},e.id)),b&&(0,r.jsx)(o.v,{title:"Charge Nurse",staffMember:b,onUpdate:L,editMode:w,size:"small"}),v&&(0,r.jsx)(o.v,{title:"Unit Clerk",staffMember:v,onUpdate:q,editMode:w,size:"small"})]})]}):(0,r.jsx)("div",{className:"bg-white rounded-lg border p-4",children:(0,r.jsx)("p",{className:"text-center text-gray-500",children:"Unit not found"})})}function m(){let[e,s]=(0,i.useState)([]),[t,a]=(0,i.useState)(null),[d,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)({totalBeds:0,occupiedBeds:0,availableBeds:0,pendingAdmissions:0,pendingDischarges:0,highAcuityPatients:0});return d?(0,r.jsx)("div",{className:"container mx-auto p-6 flex items-center justify-center h-[50vh]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-t-blue-600 border-blue-200 rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading units..."})]})}):0===e.length?(0,r.jsx)("div",{className:"container mx-auto p-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"ChargeView"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"No units have been created yet. Please go to Facility Setup to create a unit."}),(0,r.jsx)("a",{href:"/facility-setup",className:"inline-block bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Go to Facility Setup"})]})}):(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"ChargeView"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Comprehensive view for charge nurses to manage unit operations."})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Unit"}),(0,r.jsx)("select",{className:"border rounded-md p-2 w-full max-w-xs",value:t?.id||"",onChange:s=>{let t=e.find(e=>e.id===s.target.value);t&&a(t)},children:e.map(e=>(0,r.jsx)("option",{value:e.id,children:e.designation},e.id))})]}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:[t.designation," Metrics"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:l.totalBeds}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Total Beds"})]}),(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-700",children:l.occupiedBeds}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Occupied"})]}),(0,r.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-purple-700",children:l.availableBeds}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Available"})]}),(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-yellow-700",children:l.pendingAdmissions}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Pending Admits"})]}),(0,r.jsxs)("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-indigo-700",children:l.pendingDischarges}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Pending Discharges"})]}),(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-700",children:l.highAcuityPatients}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"High Acuity"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3 mb-6",children:[(0,r.jsx)(n.$,{children:"Assign Patients"}),(0,r.jsx)(n.$,{variant:"outline",children:"Print Assignments"}),(0,r.jsx)(n.$,{variant:"outline",children:"Generate Report"}),(0,r.jsx)(n.$,{variant:"outline",children:"Staff Directory"})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,r.jsx)(u,{unitId:t.id})})]})]})}t(3784)},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3784:()=>{throw Error("Module build failed (from ./node_modules/next/dist/build/webpack/loaders/next-swc-loader.js):\nError:   \x1b[31mx\x1b[0m Expression expected\n     ,-[\x1b[36;1;4mC:\\Users\\kurtw\\source\\repos\\Linearthrone\\unitview_firebase\\src\\lib\\firebase.ts\x1b[0m:432:1]\n \x1b[2m429\x1b[0m | export async function deleteUnitNurses(unitId: string): Promise<void> {\n \x1b[2m430\x1b[0m |   const q = query(nursesCollection, where('unitId', '==', unitId));\n \x1b[2m431\x1b[0m |   const snapshot = await getDocs(\n \x1b[2m432\x1b[0m |   if (snapshot.empty) {\n     : \x1b[35;1m  ^^\x1b[0m\n \x1b[2m433\x1b[0m |     return;\n \x1b[2m434\x1b[0m |   }\n \x1b[2m434\x1b[0m |   \r\n     `----\n\n\nCaused by:\n    Syntax Error")},3873:e=>{"use strict";e.exports=require("path")},4784:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>l});var r=t(5239),i=t(8088),n=t(8170),a=t.n(n),d=t(893),o={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);t.d(s,o);let l={children:["",{children:["chargeview",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7418)),"C:\\Users\\kurtw\\source\\repos\\Linearthrone\\unitview_firebase\\src\\app\\chargeview\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,4431)),"C:\\Users\\kurtw\\source\\repos\\Linearthrone\\unitview_firebase\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\kurtw\\source\\repos\\Linearthrone\\unitview_firebase\\src\\app\\chargeview\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/chargeview/page",pathname:"/chargeview",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},7418:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\kurtw\\\\source\\\\repos\\\\Linearthrone\\\\unitview_firebase\\\\src\\\\app\\\\chargeview\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\kurtw\\source\\repos\\Linearthrone\\unitview_firebase\\src\\app\\chargeview\\page.tsx","default")},8119:(e,s,t)=>{Promise.resolve().then(t.bind(t,7418))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9967:(e,s,t)=>{Promise.resolve().then(t.bind(t,3289))}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[664,244],()=>t(4784));module.exports=r})();