(()=>{var e={};e.id=888,e.ids=[888],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1160:(e,t,s)=>{Promise.resolve().then(s.bind(s,7240))},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1820:e=>{"use strict";e.exports=require("os")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3496:e=>{"use strict";e.exports=require("http2")},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},4631:e=>{"use strict";e.exports=require("tls")},4712:(e,t,s)=>{Promise.resolve().then(s.bind(s,5523))},4735:e=>{"use strict";e.exports=require("events")},5043:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l});var r=s(5239),i=s(8088),n=s(8170),a=s.n(n),o=s(893),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);s.d(t,d);let l={children:["",{children:["unitview",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7240)),"C:\\Users\\kurtw\\Downloads\\unitview_firebase_implementation\\src\\app\\unitview\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4431)),"C:\\Users\\kurtw\\Downloads\\unitview_firebase_implementation\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\kurtw\\Downloads\\unitview_firebase_implementation\\src\\app\\unitview\\page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/unitview/page",pathname:"/unitview",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},5511:e=>{"use strict";e.exports=require("crypto")},5523:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var r=s(687),i=s(3210),n=s(9523),a=s(2158),o=s(9048),d=s(7777),l=s(6660),c=s(140);function u({unitId:e}){let[t,s]=(0,i.useState)(null),[u,p]=(0,i.useState)([]),[m,x]=(0,i.useState)([]),[h,b]=(0,i.useState)([]),[g,f]=(0,i.useState)(null),[v,j]=(0,i.useState)(null),[w,y]=(0,i.useState)(!1),[N,C]=(0,i.useState)(!0),[k,P]=(0,i.useState)(!1),[_,R]=(0,i.useState)({patients:{},nurses:{},pcts:{},staff:{}}),U=(0,i.useMemo)(()=>u.filter(e=>!e.assigned),[u]),q=(0,i.useCallback)(async(e,t)=>{try{let s=m.find(t=>t.id===e),r=u.find(e=>e.id===t);if(!s||!r)return;let i=[...s.assignedRooms];i.includes(r.roomNumber)||(i.push(r.roomNumber),i.sort((e,t)=>parseInt(e)-parseInt(t))),x(m.map(t=>t.id===e?{...t,assignedRooms:i}:t)),p(u.map(e=>e.id===t?{...e,assigned:!0}:e)),R(s=>({...s,nurses:{...s.nurses,[e]:{assignedRooms:i}},patients:{...s.patients,[t]:{assigned:!0}}})),await Promise.all([(0,l.Dr)(e,{assignedRooms:i}),(0,l.Z6)(t,{assigned:!0})]),R(s=>{let{[e]:r,...i}=s.nurses,{[t]:n,...a}=s.patients;return{...s,nurses:i,patients:a}})}catch(e){console.error("Error assigning patient:",e),(0,c.oR)({title:"Error",description:"Failed to assign patient. Changes will be saved when connection is restored.",variant:"destructive"})}},[m,u]),E=(0,i.useCallback)(async(e,t)=>{try{let s=m.find(t=>t.id===e),r=u.find(e=>e.roomNumber===t);if(!s||!r)return;let i=s.assignedRooms.filter(e=>e!==t);x(m.map(t=>t.id===e?{...t,assignedRooms:i}:t)),p(u.map(e=>e.roomNumber===t?{...e,assigned:!1}:e)),R(t=>({...t,nurses:{...t.nurses,[e]:{assignedRooms:i}},patients:{...t.patients,[r.id]:{assigned:!1}}})),await Promise.all([(0,l.Dr)(e,{assignedRooms:i}),(0,l.Z6)(r.id,{assigned:!1})]),R(t=>{let{[e]:s,...i}=t.nurses,{[r.id]:n,...a}=t.patients;return{...t,nurses:i,patients:a}})}catch(e){console.error("Error unassigning patient:",e),(0,c.oR)({title:"Error",description:"Failed to unassign patient. Changes will be saved when connection is restored.",variant:"destructive"})}},[m,u]),S=(0,i.useCallback)(async(e,t)=>{try{x(m.map(s=>s.id===e?{...s,...t}:s)),R(s=>({...s,nurses:{...s.nurses,[e]:{...s.nurses[e],...t}}})),await (0,l.Dr)(e,t),R(t=>{let{[e]:s,...r}=t.nurses;return{...t,nurses:r}}),(0,c.oR)({title:"Nurse Updated",description:"Nurse information has been updated"})}catch(e){console.error("Error updating nurse:",e),(0,c.oR)({title:"Error",description:"Failed to update nurse information. Changes will be saved when connection is restored.",variant:"destructive"})}},[m]),M=(0,i.useCallback)(async(e,t)=>{try{b(h.map(s=>s.id===e?{...s,...t}:s)),R(s=>({...s,pcts:{...s.pcts,[e]:{...s.pcts[e],...t}}})),await (0,l.B5)(e,t),R(t=>{let{[e]:s,...r}=t.pcts;return{...t,pcts:r}}),(0,c.oR)({title:"PCT Updated",description:"PCT information has been updated"})}catch(e){console.error("Error updating PCT:",e),(0,c.oR)({title:"Error",description:"Failed to update PCT information. Changes will be saved when connection is restored.",variant:"destructive"})}},[h]),D=(0,i.useCallback)(async e=>{try{if(!g)return;f({...g,...e}),R(t=>({...t,staff:{...t.staff,[g.id]:{...t.staff[g.id],...e}}})),await (0,l.e4)(g.id,e),R(e=>{let{[g.id]:t,...s}=e.staff;return{...e,staff:s}}),(0,c.oR)({title:"Charge Nurse Updated",description:"Charge nurse information has been updated"})}catch(e){console.error("Error updating charge nurse:",e),(0,c.oR)({title:"Error",description:"Failed to update charge nurse information. Changes will be saved when connection is restored.",variant:"destructive"})}},[g]),F=(0,i.useCallback)(async e=>{try{if(!v)return;j({...v,...e}),R(t=>({...t,staff:{...t.staff,[v.id]:{...t.staff[v.id],...e}}})),await (0,l.e4)(v.id,e),R(e=>{let{[v.id]:t,...s}=e.staff;return{...e,staff:s}}),(0,c.oR)({title:"Unit Clerk Updated",description:"Unit clerk information has been updated"})}catch(e){console.error("Error updating unit clerk:",e),(0,c.oR)({title:"Error",description:"Failed to update unit clerk information. Changes will be saved when connection is restored.",variant:"destructive"})}},[v]),O=(0,i.useCallback)(async()=>{try{let e=Object.entries(_.patients).map(([e,t])=>({id:e,data:t}));e.length>0&&await (0,l.cT)(e),await Promise.all([...Object.entries(_.nurses).map(([e,t])=>(0,l.Dr)(e,t)),...Object.entries(_.pcts).map(([e,t])=>(0,l.B5)(e,t)),...Object.entries(_.staff).map(([e,t])=>(0,l.e4)(e,t))]),R({patients:{},nurses:{},pcts:{},staff:{}}),y(!1),(0,c.oR)({title:"Layout Saved",description:"Unit layout has been saved successfully"})}catch(e){console.error("Error saving layout:",e),(0,c.oR)({title:"Error",description:"Failed to save some changes. Please try again.",variant:"destructive"})}},[_]),A=(0,i.useMemo)(()=>Object.keys(_.patients).length>0||Object.keys(_.nurses).length>0||Object.keys(_.pcts).length>0||Object.keys(_.staff).length>0,[_]);return N||k?(0,r.jsx)("div",{className:"bg-white rounded-lg border p-4 flex items-center justify-center h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-600 border-blue-200 rounded-full animate-spin mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-gray-600",children:k?"Initializing unit data...":"Loading..."})]})}):t?(0,r.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold",children:[t.designation," Patient Grid"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[A&&(0,r.jsxs)("div",{className:"text-amber-600 text-sm flex items-center",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 bg-amber-600 rounded-full mr-1"}),"Unsaved changes"]}),(0,r.jsx)(n.$,{variant:w?"default":"outline",onClick:()=>w?O():y(!0),children:w?"Save Layout":"Edit Layout"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-medium mb-3",children:"Unassigned Patients"}),(0,r.jsxs)("div",{className:"space-y-2",children:[U.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center p-2 border rounded bg-gray-50",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"font-medium",children:["Room ",e.roomNumber]}),e.name&&(0,r.jsx)("span",{className:"ml-2 text-sm",children:e.name})]}),(0,r.jsxs)("span",{className:`px-2 py-1 rounded-full text-xs ${e.acuity>=4?"bg-red-100 text-red-800":e.acuity>=3?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:["Acuity ",e.acuity]})]},e.id)),0===U.length&&(0,r.jsx)("p",{className:"text-sm text-gray-500 italic",children:"All patients assigned"})]})]}),m.map(e=>(0,r.jsx)(a.c,{nurse:e,patients:u,onAssign:t=>q(e.id,t),onUnassign:t=>E(e.id,t),onUpdate:t=>S(e.id,t),editMode:w},e.id)),h.map(e=>(0,r.jsx)(o.I,{pct:e,onUpdate:t=>M(e.id,t),editMode:w},e.id)),g&&(0,r.jsx)(d.v,{title:"Charge Nurse",staffMember:g,onUpdate:D,editMode:w,size:"small"}),v&&(0,r.jsx)(d.v,{title:"Unit Clerk",staffMember:v,onUpdate:F,editMode:w,size:"small"})]})]}):(0,r.jsx)("div",{className:"bg-white rounded-lg border p-4",children:(0,r.jsx)("p",{className:"text-center text-gray-500",children:"Unit not found"})})}var p=s(4780);function m({className:e,...t}){return(0,r.jsx)("div",{className:(0,p.cn)("animate-pulse rounded-md bg-gray-200",e),...t})}function x(){return(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)(m,{className:"h-8 w-48 mb-2"}),(0,r.jsx)(m,{className:"h-4 w-96"})]}),(0,r.jsx)(m,{className:"h-10 w-full max-w-xs mb-6"}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-8",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-[50vh]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-t-blue-600 border-blue-200 rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading units..."})]})})})]})}function h(){return(0,r.jsx)("div",{className:"container mx-auto p-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"UnitView"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"No units have been created yet. Please go to Facility Setup to create a unit."}),(0,r.jsx)("a",{href:"/facility-setup",className:"inline-block bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Go to Facility Setup"})]})})}function b(){let[e,t]=(0,i.useState)([]),[s,n]=(0,i.useState)(null),[a,o]=(0,i.useState)(!0);return a?(0,r.jsx)(x,{}):0===e.length?(0,r.jsx)(h,{}):(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"UnitView"}),(0,r.jsx)("p",{className:"text-gray-600",children:"View and manage patient assignments for nursing units."})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Unit"}),(0,r.jsx)("select",{className:"border rounded-md p-2 w-full max-w-xs",value:s?.id||"",onChange:t=>{let s=e.find(e=>e.id===t.target.value);s&&n(s)},children:e.map(e=>(0,r.jsx)("option",{value:e.id,children:e.designation},e.id))})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,r.jsx)(i.Suspense,{fallback:(0,r.jsx)("div",{className:"p-8 flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-600 border-blue-200 rounded-full animate-spin"})}),children:s?(0,r.jsx)(u,{unitId:s.id}):(0,r.jsx)("div",{className:"p-8 text-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"Please select a unit to view"})})})})]})}},7240:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\kurtw\\\\Downloads\\\\unitview_firebase_implementation\\\\src\\\\app\\\\unitview\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\kurtw\\Downloads\\unitview_firebase_implementation\\src\\app\\unitview\\page.tsx","default")},7366:e=>{"use strict";e.exports=require("dns")},7910:e=>{"use strict";e.exports=require("stream")},8354:e=>{"use strict";e.exports=require("util")},9021:e=>{"use strict";e.exports=require("fs")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")},9771:e=>{"use strict";e.exports=require("process")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[664,655,28],()=>s(5043));module.exports=r})();